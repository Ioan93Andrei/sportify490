<div class="show-card">
  <div>
    <div class="event-name-show">
      <h2 class=""><%= @event.name %></h2>
    </div>
    <div class="d-flex justify-content-between event-info-show">
      <div class="d-flex justify-content-between">
        <p><span class="card-category"><%= @event.sport %></span></p>
        <% if @event.level == "Beginner" %>
          <p class="text-success ml-2"><%= @event.level %></p>
        <% elsif @event.level == "Intermediate" %>
          <p class="text-warning ml-2"><%= @event.level %></p>
        <% else %>
          <p class="text-danger ml-2"><%= @event.level %></p>
        <% end %>
      </div>
      <div>
        <p> <%= @event.bookings.count + 1 %> / <%= @event.capacity %></p>
      </div>
    </div>
  </div>
</div>

<div class="card-price">
  <%# Dynamically change the amount of bookings made for that event + add if statement to change color of text %>
  <% @participants_request.each do |booking| %>
    <% if current_user == @event.user %>
      <div class="btn-group">
        <button type="button" class="btn btn-primary dropdown-button dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <%= booking.status %>
        </button>
        <div class="dropdown-menu ">
          <div class="menu-height">
            <%= link_to 'Approve', booking_accept_path(booking), method: :post, class: "approve-link dropdown-item" %>
            <%= link_to 'Cancel', booking_cancel_path(booking), method: :post, class: "approve-link dropdown-item" %>
          </div>
        </div>
      </div>


    <% end %>
  <% end %>
</div>

<div class="container">
  <div class="d-flex justify-content-between show-card-avatar">
    <div>
    <% if @event.user.photo.attached? %>
      <%= cl_image_tag @event.user.photo.key, class: "img-card-avatar" %>
    <% else %>
      <%= image_tag 'avatar-backup.svg', width: 74 %>
    <% end %>
      <p class="center-text"><%= @event.user.username %></p>
    </div>
    <div>
      <p id="background-description"><%= @event.description %></p>
    </div>
  </div>

<!-- Reviews
  <% if @event.users.include?(current_user) %>
    <div class="show-card-desc">
      <% @event.users.each do |user| %>
      <% if  %>

      <% end %>
        <%= cl_image_tag user.photo.key, class: "img-card-avatar" %>
      <% end %>
    </div>
  <% end %>
-->
  <div class="show-card-desc">
    <div>
      <p><i class="icon-blue far fa-calendar-alt"></i> <%= @event.date.strftime("%d/%m/%Y") %></p>
    </div>
    <div>
      <p><i class="icon-blue far fa-clock"></i> <%= @event.date.strftime("%l:%M%p") %></p>
    </div>
    <div>
      <p><i class="icon-blue fas fa-money-bill-wave"></i> <%= @event.price %>â‚¬</p>
    </div>
    <div>
      <p><i class="icon-blue fas fa-location-arrow"></i> <%= @event.location %></p>
    </div>
  </div>
</div>

<div id="showmap"
   style="width: 100%; height: 150px;"
   data-marker="<%= @marker.to_json %>"
   data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>"></div>

<div class="d-flex justify-content-center align-content-center">
  <% if @event.user != current_user %>
    <%= simple_form_for [@event, @booking] do |f| %>
        <%= f.button :submit, 'Join!', class: "btn btn-primary text-white btn-md" %>
    <% end %>
  <% end %>

  <% if policy(@event).update? %>
    <%= link_to 'Edit', edit_event_path(@event), class: "btn btn-outline-primary btn-md my-2" %>
  <% end %>

  <% if policy(@event).destroy? %>
    <%= link_to 'Delete', @event, method: :delete, data: { confirm: 'Are you sure you want to delete this event?' }, class: "ml-3 btn btn-outline-danger btn-md my-2" %>
  <% end %>
</div>
 <!--  <div>
    <p>....comments....</p>
  </div> -->

